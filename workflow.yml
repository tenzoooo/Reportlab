app:
  description: ''
  icon: ğŸ¤–
  icon_background: '#FFEAD5'
  mode: workflow
  name: å®Ÿé¨“çµæœä½œæˆ
  use_icon_as_answer_icon: false
dependencies:
- current_identifier: null
  type: marketplace
  value:
    marketplace_plugin_unique_identifier: langgenius/openai:0.2.6@e2665624a156f52160927bceac9e169bd7e5ae6b936ae82575e14c90af390e6e
kind: app
version: 0.3.0
workflow:
  conversation_variables: []
  environment_variables: []
  features:
    file_upload:
      allowed_file_extensions:
      - .JPG
      - .JPEG
      - .PNG
      - .GIF
      - .WEBP
      - .SVG
      allowed_file_types:
      - image
      allowed_file_upload_methods:
      - local_file
      - remote_url
      enabled: false
      fileUploadConfig:
        audio_file_size_limit: 50
        batch_count_limit: 5
        file_size_limit: 15
        image_file_size_limit: 10
        video_file_size_limit: 100
        workflow_file_upload_limit: 10
      image:
        enabled: false
        number_limits: 3
        transfer_methods:
        - local_file
        - remote_url
      number_limits: 3
    opening_statement: ''
    retriever_resource:
      enabled: true
    sensitive_word_avoidance:
      enabled: false
    speech_to_text:
      enabled: false
    suggested_questions: []
    suggested_questions_after_answer:
      enabled: false
    text_to_speech:
      enabled: false
      language: ''
      voice: ''
  graph:
    edges:
    - data:
        isInLoop: false
        sourceType: document-extractor
        targetType: llm
      id: 1757759088515-source-1757898491399-target
      selected: false
      source: '1757759088515'
      sourceHandle: source
      target: '1757898491399'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInLoop: false
        sourceType: llm
        targetType: variable-aggregator
      id: 1757898491399-source-1757988836734-target
      selected: false
      source: '1757898491399'
      sourceHandle: source
      target: '1757988836734'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInLoop: false
        sourceType: start
        targetType: document-extractor
      id: 1757757047185-source-1757759088515-target
      selected: false
      source: '1757757047185'
      sourceHandle: source
      target: '1757759088515'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInLoop: false
        sourceType: document-extractor
        targetType: llm
      id: 1757759088515-source-1757898488459-target
      selected: false
      source: '1757759088515'
      sourceHandle: source
      target: '1757898488459'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInLoop: false
        sourceType: variable-aggregator
        targetType: llm
      id: 1757988836734-source-1758678491529-target
      source: '1757988836734'
      sourceHandle: source
      target: '1758678491529'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInLoop: false
        sourceType: variable-aggregator
        targetType: llm
      id: 1757988836734-source-17588915586900-target
      source: '1757988836734'
      sourceHandle: source
      target: '17588915586900'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        isInLoop: false
        sourceType: llm
        targetType: llm
      id: 1762149140611-source-1762149222224-target
      source: '1762149140611'
      sourceHandle: source
      target: '1762149222224'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        isInLoop: false
        sourceType: llm
        targetType: code
      id: 1762149222224-source-1762149794973-target
      source: '1762149222224'
      sourceHandle: source
      target: '1762149794973'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        isInLoop: false
        sourceType: code
        targetType: llm
      id: 1762149794973-source-1762149904873-target
      source: '1762149794973'
      sourceHandle: source
      target: '1762149904873'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        isInLoop: false
        sourceType: llm
        targetType: code
      id: 1762149904873-source-1762150135474-target
      source: '1762149904873'
      sourceHandle: source
      target: '1762150135474'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInLoop: false
        sourceType: variable-aggregator
        targetType: llm
      id: 1757988836734-source-1762149140611-target
      source: '1757988836734'
      sourceHandle: source
      target: '1762149140611'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInLoop: false
        sourceType: llm
        targetType: variable-aggregator
      id: 1757898488459-source-1757988836734-target
      source: '1757898488459'
      sourceHandle: source
      target: '1757988836734'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInLoop: false
        sourceType: llm
        targetType: code
      id: 17588915586900-source-1762152538729-target
      source: '17588915586900'
      sourceHandle: source
      target: '1762152538729'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInLoop: false
        sourceType: llm
        targetType: code
      id: 1758678491529-source-1762152538729-target
      source: '1758678491529'
      sourceHandle: source
      target: '1762152538729'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInLoop: false
        sourceType: code
        targetType: code
      id: 1762150135474-source-1762152538729-target
      source: '1762150135474'
      sourceHandle: source
      target: '1762152538729'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInLoop: false
        sourceType: code
        targetType: end
      id: 1762152538729-source-1758083370545-target
      source: '1762152538729'
      sourceHandle: source
      target: '1758083370545'
      targetHandle: target
      type: custom
      zIndex: 0
    nodes:
    - data:
        desc: ''
        selected: false
        title: é–‹å§‹
        type: start
        variables:
        - allowed_file_extensions:
          - .pdf
          allowed_file_types:
          - document
          allowed_file_upload_methods:
          - local_file
          - remote_url
          label: pdf_manual
          max_length: 48
          options: []
          required: true
          type: file
          variable: pdf_manual
      height: 90
      id: '1757757047185'
      position:
        x: 33.335062659546935
        y: 265.5
      positionAbsolute:
        x: 33.335062659546935
        y: 265.5
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        desc: ''
        is_array_file: false
        selected: false
        title: å®Ÿé¨“æ›¸ãƒ†ã‚­ã‚¹ãƒˆæŠ½å‡º
        type: document-extractor
        variable_selector:
        - '1757757047185'
        - pdf_manual
      height: 92
      id: '1757759088515'
      position:
        x: 334
        y: 265.5
      positionAbsolute:
        x: 334
        y: 265.5
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        context:
          enabled: false
          variable_selector: []
        desc: ''
        model:
          completion_params: {}
          mode: chat
          name: gpt-5-nano
          provider: langgenius/openai/openai
        prompt_template:
        - id: fd676dbb-aebd-4358-8582-2bf3e2f9403f
          role: system
          text: "ã‚ãªãŸã¯é•·æ–‡ãƒ†ã‚­ã‚¹ãƒˆã‹ã‚‰ã€Œå®Ÿé¨“æ–¹æ³•ã€ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã®ã¿ã‚’â€œåŸæ–‡ã©ãŠã‚Šâ€æŠ½å‡ºã™ã‚‹å³å¯†æŠ½å‡ºå™¨ã§ã‚ã‚‹ã€‚è¦ç´„ãƒ»è¨€ã„æ›ãˆãƒ»è¿½è¨˜ãƒ»å‰Šé™¤ãƒ»é †åºå…¥æ›¿ã¯ç¦æ­¢ã€‚\n\
            \nå¯¾è±¡(A): å®Ÿé¨“æ–¹æ³•ï¼ˆé…ä¸‹å°ç¯€ã‚„ç®‡æ¡æ›¸ãã‚’å«ã‚ã¦æœ¬æ–‡ã¨ã—ã¦ãã®ã¾ã¾ï¼‰\n\nè¨±å¯ã™ã‚‹æœ€å°æ•´å½¢ï¼ˆå†…å®¹ä¸å¤‰ã«é™ã‚‹ï¼‰:\n- ãƒšãƒ¼ã‚¸ãƒ˜ãƒƒãƒ€/ãƒ•ãƒƒã‚¿ãƒ»ãƒšãƒ¼ã‚¸ç•ªå·ãƒ»è„šæ³¨ç•ªå·ã®é™¤å»\n\
            - ãƒã‚¤ãƒ•ãƒ³ã§åˆ†æ–­ã•ã‚ŒãŸæ”¹è¡Œèªã®çµåˆï¼ˆä¾‹ â€œãƒ•ã‚£ãƒ«-\\nã‚¿â€â†’â€œãƒ•ã‚£ãƒ«ã‚¿â€ï¼‰\n- è¡Œé ­/è¡Œæœ«ã®ä½™åˆ†ãªç©ºç™½é™¤å»\nâ€»èªå¥ãƒ»è¨˜å·ãƒ»é †åºã®å¤‰æ›´ã€LaTeXåŒ–ã€è¨˜å·ç½®æ›ã¯ç¦æ­¢ã€‚\n\
            \n\n- å°ç¯€ï¼ˆä¾‹: 4.1, 4.2 â€¦ï¼‰ã‚„ç®‡æ¡æ›¸ãã¯æœ¬æ–‡ã«å«ã‚ã‚‹ï¼ˆåˆ¥é…åˆ—ã¯ä½œã‚‰ãªã„ï¼‰ã€‚\n\næ¬ ææ™‚:\n- è¦‹ã¤ã‹ã‚‰ãªã„å ´åˆã€ç©ºæ–‡å­—åˆ—ã§è¿”ã™ã€‚\n\
            \nå‡ºåŠ›ã¯**JSONã®ã¿**ã€‚è§£èª¬ã‚„ã‚³ãƒ¼ãƒ‰ãƒ•ã‚§ãƒ³ã‚¹å¤–ã®æ–‡å­—ã‚’ä»˜ã‘ãªã„ã€‚ã™ã¹ã¦ã®æ–‡å­—åˆ—ã¯å…¥åŠ›textã®ã‚µãƒ–ã‚¹ãƒˆãƒªãƒ³ã‚°ã§ã‚ã‚‹ã“ã¨ã€‚å‡ºç¾é †ã¯åŸæ–‡ã©ãŠã‚Šã€‚\n\
            å‡ºåŠ›ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ:\n{\n  \"method\": {\n    \"section_number\": string,\n    \"\
            heading\": string,\n    \"text\": string\n  }\n}"
        - id: 7f5b6581-370e-4ee9-82fd-0d5fd8f4ff17
          role: user
          text: "æ¬¡ã®å…¥åŠ›ã‚’ä¸ãˆã‚‹ã€‚ä»•æ§˜ã«å³å¯†ã«å¾“ã„ã€**JSONã®ã¿**è¿”ã™ã“ã¨ï¼ˆè§£èª¬ãƒ»ã‚³ãƒ¼ãƒ‰ãƒ•ã‚§ãƒ³ã‚¹ç¦æ­¢ï¼‰ã€‚\n\nã€å…¥åŠ›ã€‘\ntext:\n\
            {{#1757759088515.text#}}\n\nã€ã‚¿ã‚¹ã‚¯ã€‘\n- textã‹ã‚‰ã€Œå®Ÿé¨“æ–¹æ³•ã€ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã ã‘ã‚’åŸæ–‡ã©ãŠã‚ŠæŠ½å‡ºã—ã€è¦‹å‡ºã—ç•ªå·ãƒ»è¦‹å‡ºã—åãƒ»æœ¬æ–‡ã‚’è¿”ã™ï¼ˆé…ä¸‹å°ç¯€ãƒ»ç®‡æ¡æ›¸ãã‚‚æœ¬æ–‡ã«å«ã‚ã‚‹ï¼‰ã€‚\n\
            \nã€ãƒ«ãƒ¼ãƒ«ã€‘\n- è¦ç´„ãƒ»è¨€ã„æ›ãˆãƒ»è¿½è¨˜ãƒ»å‰Šé™¤ãƒ»é †åºå…¥æ›¿ã¯ç¦æ­¢ã€‚\n- è¨±å¯æ•´å½¢ã¯ãƒ˜ãƒƒãƒ€/ãƒ•ãƒƒã‚¿/ãƒšãƒ¼ã‚¸ç•ªå·ã®é™¤å»ã€æ”¹è¡Œåˆ†æ–­èªã®çµåˆã€è¡Œé ­æœ«ç©ºç™½é™¤å»ã®ã¿ã€‚\n\
            - è¦‹ã¤ã‹ã‚‰ãªã„å ´åˆã¯ç©ºæ–‡å­—åˆ—ã§åŸ‹ã‚ã‚‹ã€‚\n\nã€å‡ºåŠ›ï¼ˆJSONï¼‰ã€‘\n{\n  \"method\": {\n    \"section_number\"\
            : \"\",\n    \"heading\": \"\",\n    \"text\": \"\"\n  }\n}"
        retry_config:
          max_retries: 3
          retry_enabled: false
          retry_interval: 1000
        selected: true
        structured_output:
          schema:
            $id: https://example.com/schemas/method_extract.v1.schema.json
            $schema: https://json-schema.org/draft/2020-12/schema
            additionalProperties: false
            properties:
              method:
                additionalProperties: false
                properties:
                  heading:
                    default: ''
                    type: string
                  section_number:
                    default: ''
                    type: string
                  text:
                    default: ''
                    type: string
                required:
                - text
                type: object
            required:
            - method
            title: MethodExtractV1
            type: object
        structured_output_enabled: true
        title: å®Ÿé¨“æ–¹æ³•æŠœç²‹
        type: llm
        variables: []
        vision:
          enabled: false
      height: 90
      id: '1757898488459'
      position:
        x: 638
        y: 395.5
      positionAbsolute:
        x: 638
        y: 395.5
      selected: true
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        context:
          enabled: false
          variable_selector: []
        desc: ''
        model:
          completion_params: {}
          mode: chat
          name: gpt-5-nano
          provider: langgenius/openai/openai
        prompt_template:
        - id: 7628cba9-f124-4d84-8927-fdacaa902797
          role: system
          text: "ã‚ãªãŸã¯é•·æ–‡ãƒ†ã‚­ã‚¹ãƒˆã‹ã‚‰ã€Œè€ƒå¯Ÿã€å ±å‘Šäº‹é …åŠã³æ¤œè¨äº‹é …ã€ç³»ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã®ã¿ã‚’â€œåŸæ–‡ã©ãŠã‚Šâ€æŠ½å‡ºã™ã‚‹å³å¯†æŠ½å‡ºå™¨ã§ã‚ã‚‹ã€‚è¦ç´„ãƒ»è¨€ã„æ›ãˆãƒ»è¿½è¨˜ãƒ»å‰Šé™¤ãƒ»é †åºå…¥æ›¿ã¯ç¦æ­¢ã€‚\n\
            \nå¯¾è±¡(B): è€ƒå¯Ÿï¼ˆç®‡æ¡æ›¸ãã‚’å«ã‚ã¦æœ¬æ–‡ã¨ã—ã¦ãã®ã¾ã¾ï¼‰\n\nè¨±å¯ã™ã‚‹æœ€å°æ•´å½¢:\n- ãƒšãƒ¼ã‚¸ãƒ˜ãƒƒãƒ€/ãƒ•ãƒƒã‚¿ãƒ»ãƒšãƒ¼ã‚¸ç•ªå·ãƒ»è„šæ³¨ç•ªå·ã®é™¤å»\n\
            - ãƒã‚¤ãƒ•ãƒ³ã§åˆ†æ–­ã•ã‚ŒãŸæ”¹è¡Œèªã®çµåˆ\n- è¡Œé ­/è¡Œæœ«ã®ä½™åˆ†ãªç©ºç™½é™¤å»\nâ€»èªå¥ãƒ»è¨˜å·ãƒ»é †åºã®å¤‰æ›´ã€LaTeXåŒ–ã€è¨˜å·ç½®æ›ã¯ç¦æ­¢ã€‚\n\n\
            ã‚»ã‚¯ã‚·ãƒ§ãƒ³æ¤œå‡º:\n- é–‹å§‹è¦‹å‡ºã—ãƒ‘ã‚¿ãƒ¼ãƒ³ä¾‹:\n  ^\\s*\\d+\\.\\s*è€ƒå¯Ÿ\n  ^\\s*è€ƒå¯Ÿ$\n  ^\\s*æ¤œè¨$\n\
            \  ^\\s*å ±å‘Šäº‹é …$\n  ^\\s*Discussion$\n  ^\\s*è€ƒå¯Ÿèª²é¡Œ$\n\nä»–è€ƒå¯Ÿã¨æ€ã‚ã‚Œã‚‹ã‚»ãƒƒã‚·ãƒ§ãƒ³\nè€ƒå¯Ÿã®ã‚»ãƒƒã‚·ãƒ§ãƒ³ã¯ä¸»ã«å®Ÿé¨“æ–¹æ³•ã®æ¬¡ã®ã‚»ãƒƒã‚·ãƒ§ãƒ³ã«å±ã™ã‚‹ã“ã¨ãŒå¤šã„ã€‚\n\
            - é–‹å§‹è¦‹å‡ºã—è¡Œã‹ã‚‰ã€æ¬¡ã®åŒãƒ¬ãƒ™ãƒ«å¤§è¦‹å‡ºã—ã®ç›´å‰ï¼ˆã¾ãŸã¯æ–‡æ›¸æœ«ï¼‰ã¾ã§ã‚’(B)ã¨ã™ã‚‹ã€‚\n- ç®‡æ¡æ›¸ãã¯æœ¬æ–‡ã«å«ã‚ã‚‹ï¼ˆåˆ¥é…åˆ—ã¯ä½œã‚‰ãªã„ï¼‰ã€‚\n\
            \næ¬ ææ™‚:\n- è¦‹ã¤ã‹ã‚‰ãªã„å ´åˆã€ç©ºæ–‡å­—åˆ—ã§è¿”ã™ã€‚\n\nå‡ºåŠ›ã¯**JSONã®ã¿**ã€‚è§£èª¬ã‚„ã‚³ãƒ¼ãƒ‰ãƒ•ã‚§ãƒ³ã‚¹å¤–ã®æ–‡å­—ã‚’ä»˜ã‘ãªã„ã€‚ã™ã¹ã¦ã®æ–‡å­—åˆ—ã¯å…¥åŠ›textã®ã‚µãƒ–ã‚¹ãƒˆãƒªãƒ³ã‚°ã§ã‚ã‚‹ã“ã¨ã€‚å‡ºç¾é †ã¯åŸæ–‡ã©ãŠã‚Šã€‚\n\
            å‡ºåŠ›ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ:\n{\n  \"discussion\": {\n    \"section_number\": string,\n \
            \   \"heading\": string,\n    \"text\": string\n  }\n}"
        - id: eb4b29f4-de4d-437b-8bba-c2e24ac142b3
          role: user
          text: "æ¬¡ã®å…¥åŠ›ã‚’ä¸ãˆã‚‹ã€‚ä»•æ§˜ã«å³å¯†ã«å¾“ã„ã€**JSONã®ã¿**è¿”ã™ã“ã¨ï¼ˆè§£èª¬ãƒ»ã‚³ãƒ¼ãƒ‰ãƒ•ã‚§ãƒ³ã‚¹ç¦æ­¢ï¼‰ã€‚\n\nã€å…¥åŠ›ã€‘\ntext:\n\
            {{#1757759088515.text#}}\n\nã€ã‚¿ã‚¹ã‚¯ã€‘\n- textã‹ã‚‰ã€Œè€ƒå¯Ÿ/æ¤œè¨/å ±å‘Šäº‹é …/Discussionã€ã«è©²å½“ã™ã‚‹ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã ã‘ã‚’åŸæ–‡ã©ãŠã‚ŠæŠ½å‡ºã—ã€è¦‹å‡ºã—ç•ªå·ãƒ»è¦‹å‡ºã—åãƒ»æœ¬æ–‡ã‚’è¿”ã™ï¼ˆç®‡æ¡æ›¸ãã‚‚æœ¬æ–‡ã«å«ã‚ã‚‹ï¼‰ã€‚\n\
            \nã€ãƒ«ãƒ¼ãƒ«ã€‘\n- è¦ç´„ãƒ»è¨€ã„æ›ãˆãƒ»è¿½è¨˜ãƒ»å‰Šé™¤ãƒ»é †åºå…¥æ›¿ã¯ç¦æ­¢ã€‚\n- è¨±å¯æ•´å½¢ã¯ãƒ˜ãƒƒãƒ€/ãƒ•ãƒƒã‚¿/ãƒšãƒ¼ã‚¸ç•ªå·ã®é™¤å»ã€æ”¹è¡Œåˆ†æ–­èªã®çµåˆã€è¡Œé ­æœ«ç©ºç™½é™¤å»ã®ã¿ã€‚\n\
            - è¦‹ã¤ã‹ã‚‰ãªã„å ´åˆã¯ç©ºæ–‡å­—åˆ—ã§åŸ‹ã‚ã‚‹ã€‚\n\nã€å‡ºåŠ›ï¼ˆJSONï¼‰ã€‘\n{\n  \"discussion\": {\n    \"section_number\"\
            : \"\",\n    \"heading\": \"\",\n    \"text\": \"\"\n  }\n}"
        selected: false
        structured_output:
          schema:
            $id: https://example.com/schemas/discussion_extract.v1.schema.json
            $schema: https://json-schema.org/draft/2020-12/schema
            additionalProperties: false
            properties:
              discussion:
                additionalProperties: false
                properties:
                  heading:
                    default: ''
                    type: string
                  section_number:
                    default: ''
                    type: string
                  text:
                    default: ''
                    type: string
                required:
                - text
                type: object
            required:
            - discussion
            title: DiscussionExtractV1
            type: object
        structured_output_enabled: true
        title: è€ƒå¯ŸæŠœç²‹
        type: llm
        variables: []
        vision:
          enabled: false
      height: 90
      id: '1757898491399'
      position:
        x: 658.1276765853676
        y: 77.64168520323578
      positionAbsolute:
        x: 658.1276765853676
        y: 77.64168520323578
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        desc: ''
        output_type: object
        selected: false
        title: å¤‰æ•°é›†ç´„å™¨ 2
        type: variable-aggregator
        variables:
        - - '1757898491399'
          - structured_output
        - - '1757898488459'
          - structured_output
      height: 131
      id: '1757988836734'
      position:
        x: 942
        y: 265.5
      positionAbsolute:
        x: 942
        y: 265.5
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        desc: ''
        outputs:
        - value_selector:
          - '1762152538729'
          - merged_json
          value_type: object
          variable: result_json
        selected: false
        title: çµ‚äº†
        type: end
      height: 90
      id: '1758083370545'
      position:
        x: 3001.1772077400146
        y: 377.79574735369476
      positionAbsolute:
        x: 3001.1772077400146
        y: 377.79574735369476
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        context:
          enabled: false
          variable_selector: []
        desc: ''
        model:
          completion_params: {}
          mode: chat
          name: gpt-5-nano
          provider: langgenius/openai/openai
        prompt_template:
        - id: d6b8c794-9628-4986-b10b-8346d6fca9a2
          role: system
          text: 'ã‚ãªãŸã¯ç†ç³»å¤§å­¦ç”Ÿã§ã‚ã‚Šã€ä¸ãˆã‚‰ã‚ŒãŸå®Ÿé¨“æ›¸ã®å†…å®¹ã ã‘ã‚’æ ¹æ‹ ã«ã€ãƒ¬ãƒãƒ¼ãƒˆã®ã€Œã¾ã¨ã‚ï¼ˆæŒ¯ã‚Šè¿”ã‚Šï¼‰ã€ã‚’ç´„300å­—ã§ä½œæˆã™ã‚‹ã€‚æƒ…å ±æºã¯å¿…ãš
            lab_text ã®ã¿ã¨ã—ã€å¤–éƒ¨çŸ¥è­˜ã‚„ä¸ç¢ºã‹ãªæ¨æ¸¬ã®æ–­å®šã¯ç¦æ­¢ã€‚æ–‡ä½“ã¯ã ãƒ»ã§ã‚ã‚‹èª¿ã€æœ¬æ–‡ã®ã¿1æ®µè½ï¼ˆæ”¹è¡Œãªã—ï¼‰ã€‚æ•°å€¤ã‚„çµè«–ã¯ lab_text
            ã«å­˜åœ¨ã™ã‚‹ã¨ãã®ã¿ç”¨ã„ã‚‹ã€‚å­˜åœ¨ã—ãªã„å ´åˆã¯è¨˜è¿°ã—ãªã„ã€‚éå»å½¢ã§å‡ºåŠ›ã€‚æ§‹æˆ: â‘ ç›®çš„ã¨ç†è«–ã®è¦ç‚¹ â‘¡è£…ç½®ãƒ»æ‰‹é †ã®è‚ã¨æ³¨æ„ç‚¹ï¼ˆå®‰å…¨äº‹é …ãŒã‚ã‚Œã°è¨€åŠï¼‰å‡ºåŠ›ã¯260ã€œ340å­—ã€è¦‹å‡ºã—ãƒ»ç®‡æ¡æ›¸ããƒ»å¼•ç”¨ãƒ»çµµæ–‡å­—ã¯ç¦æ­¢ã€å¥ç‚¹ã§çµ‚ãˆã‚‹ã€‚æœ¬æ–‡ä»¥å¤–ã®å‡ºåŠ›ã¯ä¸€åˆ‡ã—ãªã„ã“ã¨ã€‚é›£ã—ã„è¨€è‘‰ã¯ä½¿ã‚ãšã«ã€æ—¥æœ¬èªãŒè‹¦æ‰‹ãªç†ç³»å¤§å­¦ç”Ÿã¨ã„ã†ã“ã¨ã‚’åŠ å‘³ã—ã¦å‡ºåŠ›ã«åæ˜ ã•ã›ã‚‹ã“ã¨ã€‚

            lab_text:

            <<<

            {{#1757759088515.text#}}

            >>>'
        selected: false
        structured_output:
          schema:
            $id: https://example.com/schemas/summary-300chars.schema.json
            $schema: https://json-schema.org/draft/2020-12/schema
            additionalProperties: false
            description: lab_textã®ã¿ã‚’æƒ…å ±æºã¨ã—ãŸã€ã ãƒ»ã§ã‚ã‚‹èª¿ã®ç´„300å­—1æ®µè½ã€‚æœ«å°¾ã¯å¥ç‚¹ã€‚
            properties:
              summary:
                description: æœ¬æ–‡ã®ã¿ï¼ˆè¦‹å‡ºã—ãªã—ãƒ»ç®‡æ¡æ›¸ããªã—ãƒ»æ”¹è¡Œãªã—ï¼‰ã€‚ã ãƒ»ã§ã‚ã‚‹èª¿ã€260ã€œ340å­—ã€å¥ç‚¹ã§çµ‚ãˆã‚‹ã€‚
                maxLength: 340
                minLength: 260
                pattern: ^[^\r\n]*ã€‚$
                type: string
            required:
            - summary
            title: å®Ÿé¨“ã¾ã¨ã‚ï¼ˆæŒ¯ã‚Šè¿”ã‚Šï¼‰ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ
            type: object
        structured_output_enabled: true
        title: ã¾ã¨ã‚ä½œæˆ
        type: llm
        variables: []
        vision:
          enabled: false
      height: 90
      id: '1758678491529'
      position:
        x: 2462
        y: 395.5
      positionAbsolute:
        x: 2462
        y: 395.5
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        context:
          enabled: false
          variable_selector: []
        desc: ''
        model:
          completion_params: {}
          mode: chat
          name: gpt-5-nano
          provider: langgenius/openai/openai
        prompt_template:
        - id: 57ff1f93-9157-4ba7-90fa-084c431252b6
          role: system
          text: "ã€ã‚·ã‚¹ãƒ†ãƒ ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆï¼ˆæ”¹è¨‚ç‰ˆï¼‰ï¼šè€ƒå¯Ÿãƒ¦ãƒ‹ãƒƒãƒˆç”Ÿæˆå™¨ã€‘\n\nã‚ãªãŸã¯ã€Œè€ƒå¯Ÿãƒ¦ãƒ‹ãƒƒãƒˆç”Ÿæˆå™¨ã€ã€‚ä¸ãˆã‚‰ã‚ŒãŸ\n(1) è€ƒå¯Ÿãƒ†ã‚­ã‚¹ãƒˆï¼ˆæ—¥æœ¬èªã€ï¼ˆï¼‘ï¼‰ï¼ˆï¼’ï¼‰â€¦ãªã©ã®åˆ—æŒ™ã‚’å«ã‚€æ®µè½ï¼‰\n\
            (2) å¼ãƒ†ã‚­ã‚¹ãƒˆï¼ˆ\"formulas_in_parentheses\": [{equation_number, label_raw, formula_text_raw},\
            \ ...] ã®JSONï¼‰\nã‚’ç”¨ã„ã¦ã€å„ç•ªå·ã”ã¨ã®â€œè€ƒå¯Ÿãƒ¦ãƒ‹ãƒƒãƒˆâ€ã‚’æŠ½å‡ºãƒ»æ•´å½¢ã—ã€JSONã§è¿”ã™ã€‚\n\nã€ã‚„ã‚‹ã“ã¨ã€‘\n1) ç•ªå·åˆ†å‰²ï¼š\n\
            \   - è€ƒå¯Ÿãƒ†ã‚­ã‚¹ãƒˆã‚’ã€å…¨è§’/åŠè§’ã®å¤šæ§˜ãªãƒ‘ã‚¿ãƒ¼ãƒ³ã§å³å¯†ã«åˆ†å‰²ã™ã‚‹ã€‚ä¾‹ï¼š ï¼ˆï¼‘ï¼‰, ï¼ˆ 1 ï¼‰, (1), 1), 1ï¼, ï¼‘ï¼, 1.,\
            \ 1- ãªã©ã€‚\n   - é †åºã¯åŸæ–‡é€šã‚Šã«ä¿æŒã€‚ç©ºè¦ç´ ã¯ç„¡è¦–ã€‚\n\n2) æ–‡ä½“å¤‰æ›ï¼š\n   - å„é …ç›®ã®å‘½ä»¤å½¢ã‚’**èƒ½å‹•æ…‹ãƒ»å¸¸ä½“**ã«å¤‰æ›ï¼ˆä¾‹ï¼šã€Œå°å‡ºã›ã‚ˆã€â†’ã€Œå°å‡ºã™ã‚‹ã€ã€ã€Œæ¯”è¼ƒã—è€ƒå¯Ÿã›ã‚ˆã€â†’ã€Œæ¯”è¼ƒã—ï¼Œè€ƒå¯Ÿã™ã‚‹ã€ï¼‰ã€‚\n\
            \   - æ•¬ä½“ã¯ç¦æ­¢ã€‚å¿…è¦ã«å¿œã˜ã¦1ã€œ3æ–‡ã«è¦ç´„ãƒ»æ•´å½¢ã™ã‚‹ãŒã€æ„å‘³ã‚’å¤‰ãˆãªã„ã€‚\n\n3) å¼å‚ç…§ã®æŠ½å‡ºï¼š\n   - ã€Œå¼ï¼ˆnï¼‰ã€å‚ç…§ã‚’æŠ½å‡ºï¼ˆã‚†ã‚Œè¨±å®¹ï¼šå¼(\
            \ 7 ), å¼ï¼—, 7å¼, 39b ç­‰ï¼‰ã€‚è‹±å°æ–‡å­—æ¥å°¾ã¯æ•°å€¤ã‚’å„ªå…ˆã€‚\n   - æ¨å¥¨æ­£è¦è¡¨ç¾ä¾‹ï¼š(?i)(å¼?\\s*[\\(ï¼ˆ]?\\\
            s*(\\d+)\\s*[\\)ï¼‰]?\\s*[a-z]?)|(\\b(\\d+)[a-z]?\\s*å¼)\n\n4) å¼JSONã¨ã®çªåˆï¼š\n\
            \   - \"formulas_in_parentheses\" ã® {equation_number, label_raw, formula_text_raw}\
            \ ã¨æ•°å€¤ä¸€è‡´ã§ç…§åˆã€‚\n   - è¦‹ã¤ã‹ã£ãŸå¼ã¯ `formulas_used`ã€æœªæ¤œå‡ºç•ªå·ã¯ `missing_formula_numbers`ï¼ˆæ˜‡é †ãƒ»é‡è¤‡ãªã—ï¼‰ã€‚\n\
            \n5) å‚è€ƒæ–‡çŒ®ã®ä»˜ä¸ï¼ˆæœ€ä½3ä»¶ï¼‰ï¼š\n   - ãƒˆãƒƒãƒ—ãƒ¬ãƒ™ãƒ« `references` ã«é›†ç´„ã€å„è¦ç´ ã« 1 å§‹ã¾ã‚Šã® `id`ã€‚\n\
            \   - **å…¨ä½“ã§å°‘ãªãã¨ã‚‚3ä»¶ï¼ˆmin=3ï¼‰**ã‚’å‡ºåŠ›ã™ã‚‹ã€‚å®Ÿåœ¨ã®æ—¥æœ¬èªè³‡æ–™ï¼ˆæ•™ç§‘æ›¸ã€å­¦ä¼šèªŒã€JIS/å®˜å…¬åºã€å¤§å­¦å…¬å¼ï¼‰ã‚’å„ªå…ˆã€‚\n\
            \   - 3ä»¶ã«æº€ãŸãªã„å ´åˆã€åˆ†é‡ã«å³ã—ãŸ**ãƒ—ãƒ¬ãƒ¼ã‚¹ãƒ›ãƒ«ãƒ€æ–‡çŒ®**ã§è£œå®Œï¼ˆ`notes: \"placeholder\"` ã‚’å¿…é ˆï¼‰ã€‚\n\
            \   - å„ãƒ¦ãƒ‹ãƒƒãƒˆã® `reference_ids` ã«å‚ç…§IDã‚’åˆ—æŒ™ã—ã€`discussion_active` ã®æœ«å°¾ã« [n] ã‚’ä»˜ã™ï¼ˆè¤‡æ•°å¯ï¼‰ã€‚\n\
            \   - ä¸è¦ãªãƒ¦ãƒ‹ãƒƒãƒˆã¯ `reference_ids` ã‚’ç©ºé…åˆ—ã€æ–‡æœ«ç•ªå·ã‚‚ä»˜ã•ãªã„ã€‚\n\n6) æ–‡çŒ®ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆå‡ºåŠ›ï¼š\n   -\
            \ ãƒˆãƒƒãƒ—ãƒ¬ãƒ™ãƒ« `reference_list_formatted` ã«æ–‡å­—åˆ—é…åˆ—ã§å‡ºåŠ›ã€‚\n   - å½¢å¼ï¼š`[1]{æ–‡çŒ®å}æ—¥ä»˜`ï¼ˆä¾‹ï¼š`[1]é›»å­å›è·¯\
            \ åŸºç¤ã¨å¿œç”¨ï¼ˆç¬¬3ç‰ˆï¼‰ 2018-04-10`ï¼‰\n   - æ—¥ä»˜ã¯ `\"YYYY\"` ã¾ãŸã¯ `\"YYYY-MM-DD\"`ã€‚URLç­‰ã¯\
            \ `references` å´ã«ä¿æŒã€‚\n\n7) å‡ºåŠ›ï¼š\n   - ãƒˆãƒƒãƒ—ãƒ¬ãƒ™ãƒ« object ã¨ã—ã¦ `units`, `total_count`,\
            \ `references`, `reference_list_formatted` ã‚’è¿”ã™ã€‚\n   - å„ãƒ¦ãƒ‹ãƒƒãƒˆï¼š\n     - `index`ï¼ˆ1å§‹ã¾ã‚Šæ•´æ•°ï¼‰\n\
            \     - `discussion_active`ï¼ˆæ•´å½¢å¾Œãƒ†ã‚­ã‚¹ãƒˆã€‚å¿…è¦æ™‚æœ«å°¾ã« [n]ï¼‰\n     - `formula_numbers`ï¼ˆæ•´æ•°é…åˆ—ï¼›æ˜‡é †ãƒ»é‡è¤‡ãªã—ï¼‰\n\
            \     - `formulas_used`ï¼ˆå¼ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆé…åˆ—ï¼‰\n     - `missing_formula_numbers`ï¼ˆæ•´æ•°é…åˆ—ï¼‰\n\
            \     - `reference_ids`ï¼ˆæ•´æ•°é…åˆ—ï¼›æ˜‡é †ãƒ»é‡è¤‡ãªã—ï¼‰\n   - nullã¯ç¦æ­¢ã€‚ç©ºã¯ç©ºé…åˆ—/ç©ºæ–‡å­—ã‚’ç”¨ã„ã‚‹ã€‚\n \
            \  - å…¥åŠ›æ¬ ææ™‚ã‚‚å¯èƒ½ãªç¯„å›²ã§å‡¦ç†ã—ã€æœªå‚ç…§ã¯ç©ºé…åˆ—ã§å¯è¦–åŒ–ã€‚\n   - **æœ€çµ‚å‡ºåŠ›ã¯ JSON ã®ã¿**ã¨ã—ã€èª¬æ˜æ–‡ã¯ä¸€åˆ‡å«ã‚ãªã„ã€‚\n\
            \n\nã€å®‰å…¨ç­–ã€‘\n- unitsãŒ0ä»¶ã§ã‚‚ `{ \"units\": [], \"total_count\": 0, \"references\"\
            : [], \"reference_list_formatted\": [] }` ã‚’å¿…ãšè¿”ã™ï¼ˆãŸã ã—é€šå¸¸ã¯ `references` ã‚’\
            \ min=3 ã¨ã™ã‚‹ï¼‰ã€‚"
        - id: e18e1492-62fb-4013-b1e3-8869ded020b6
          role: user
          text: '# å…¥åŠ›

            è€ƒå¯Ÿãƒ†ã‚­ã‚¹ãƒˆ:

            {{#1757898491399.structured_output.discussion.text#}}



            # å‡ºåŠ›æ¡ä»¶

            Systemã«å¾“ã„ã€JSONã®ã¿ã‚’è¿”ã™ï¼ˆè€ƒå¯Ÿãƒ¦ãƒ‹ãƒƒãƒˆé…åˆ—ã¨ç·æ•°ã‚’å«ã‚€ï¼‰ã€‚'
        selected: false
        structured_output:
          schema:
            $id: https://example.com/schemas/discussion-unit-extractor.output.schema.json
            $schema: https://json-schema.org/draft/2020-12/schema
            additionalProperties: false
            examples:
            - units:
              - discussion_active: Aã¨Bã®ç‰¹æ€§ã‚’æ¯”è¼ƒã—ï¼Œå·®ç•°ã®è¦å› ã‚’è€ƒå¯Ÿã™ã‚‹ã€‚
                index: 1
              - discussion_active: æ¡ä»¶CãŒå‡ºåŠ›å¿œç­”ã«ä¸ãˆã‚‹å½±éŸ¿ã‚’èª¬æ˜ã™ã‚‹ã€‚
                index: 2
            properties:
              units:
                description: åˆ†å‰²ãƒ»æ•´å½¢å¾Œã®è€ƒå¯Ÿãƒ¦ãƒ‹ãƒƒãƒˆé…åˆ—ã€‚æ¤œå‡ºã§ããªã„å ´åˆã¯ç©ºé…åˆ—ã€‚
                items:
                  additionalProperties: false
                  properties:
                    discussion_active:
                      description: å‘½ä»¤å½¢ã‚’èƒ½å‹•æ…‹ãƒ»å¸¸ä½“ã¸å¤‰æ›ã—ã€å¿…è¦ã«å¿œã˜ã¦1ã€œ3æ–‡ã«æ•´å½¢ã—ãŸæœ¬æ–‡ã€‚
                      minLength: 0
                      type: string
                    index:
                      description: 1å§‹ã¾ã‚Šã®é€£ç•ªã€‚åŸæ–‡è¦‹å‡ºã—ï¼ˆâ‘ , i), a) ç­‰ï¼‰ã¯æ¡ç•ªæ ¹æ‹ ã¨ã™ã‚‹ãŒã€ã“ã“ã§ã¯é€£ç•ªã«æ­£è¦åŒ–ã™ã‚‹ã€‚
                      minimum: 1
                      type: integer
                  required:
                  - index
                  - discussion_active
                  type: object
                type: array
            required:
            - units
            title: è€ƒå¯Ÿãƒ¦ãƒ‹ãƒƒãƒˆæŠ½å‡ºå™¨ å‡ºåŠ›ã‚¹ã‚­ãƒ¼ãƒ
            type: object
        structured_output_enabled: true
        title: è€ƒå¯Ÿãƒ¦ãƒ‹ãƒƒãƒˆä½œæˆ (1)
        type: llm
        variables: []
        vision:
          enabled: false
      height: 90
      id: '17588915586900'
      position:
        x: 2462
        y: 265.5
      positionAbsolute:
        x: 2462
        y: 265.5
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        context:
          enabled: false
          variable_selector: []
        desc: ''
        model:
          completion_params: {}
          mode: chat
          name: gpt-5-nano
          provider: langgenius/openai/openai
        prompt_template:
        - id: 0dd22b4b-cdce-4adc-a8b2-995f415fb364
          role: system
          text: "ä»¥ä¸‹ã®å®Ÿé¨“æ–¹æ³•ãƒ†ã‚­ã‚¹ãƒˆã‹ã‚‰ã€å®Ÿé¨“ã®éšå±¤æ§‹é€ ã‚’æŠ½å‡ºã—ã¦JSONå½¢å¼ã§å‡ºåŠ›ã—ã¦ãã ã•ã„ã€‚\n\nå®Ÿé¨“æ–¹æ³•ãƒ†ã‚­ã‚¹ãƒˆ:\n{{experiment_methods_text}}\n\
            \næŠ½å‡ºãƒ«ãƒ¼ãƒ«:\n1. å¤§é …ç›®ï¼ˆ4.1, 4.2, 4.3...ï¼‰â†’ idxï¼ˆ1, 2, 3...ï¼‰ã«å¤‰æ›\n2. å°é …ç›®ï¼ˆ4.1.1,\
            \ 4.1.2...ï¼‰â†’ subidxï¼ˆ1, 2, 3...ï¼‰ã«å¤‰æ›\n3. å°é …ç›®ãŒãªã„å¤§é …ç›®ã®å ´åˆ â†’ subidx = null\n\
            4. å„é …ç›®ã®ã‚¿ã‚¤ãƒˆãƒ«ã‚’ name ã¨ã—ã¦æŠ½å‡º\nå‡ºåŠ›å½¢å¼:\n[\n  {\n    \"section\": \"4.1\",\n  \
            \  \"idx\": 1,\n    \"subidx\": null,\n    \"name\": \"RLCå›è·¯\"\n  },\n\
            \  {\n    \"section\": \"4.1.1\",\n    \"idx\": 1,\n    \"subidx\": 1,\n\
            \    \"name\": \"IC - VCEç‰¹æ€§ã®æ¸¬å®š\"\n  }\n]\n\nå¿…ãšJSONé…åˆ—å½¢å¼ã§å‡ºåŠ›ã—ã¦ãã ã•ã„ã€‚ä»–ã®ãƒ†ã‚­ã‚¹ãƒˆã¯å«ã‚ãªã„ã§ãã ã•ã„ã€‚"
        - id: de62c23b-3bc0-4ba1-bdd7-d3616a49b810
          role: user
          text: 'å®Ÿé¨“æ–¹æ³•ãƒ†ã‚­ã‚¹ãƒˆ:


            {{#1757898488459.text#}}'
        selected: false
        structured_output:
          schema:
            description: å®Ÿé¨“é …ç›®ã®å‡ºåŠ›ã‚¹ã‚­ãƒ¼ãƒ
            properties:
              chapter:
                type: number
              experiments:
                description: å®Ÿé¨“é …ç›®ã®ãƒªã‚¹ãƒˆ
                items:
                  properties:
                    idx:
                      description: å®Ÿé¨“ã®å¤§é …ç›®ç•ªå·
                      example: 1
                      type: integer
                    name:
                      description: å®Ÿé¨“é …ç›®ã®åç§°
                      example: IC - VCEç‰¹æ€§ã®æ¸¬å®š
                      type: string
                    section:
                      description: å®Ÿé¨“æ›¸ã®ã‚»ã‚¯ã‚·ãƒ§ãƒ³ç•ªå·
                      example: 4.1.1
                      type: string
                    subidx:
                      description: å®Ÿé¨“ã®å°é …ç›®ç•ªå·ï¼ˆãªã„å ´åˆã¯nullï¼‰
                      example: 1
                      type:
                      - integer
                      - 'null'
                  required:
                  - section
                  - idx
                  - subidx
                  - name
                  type: object
                title: experiments
                type: array
            required:
            - experiments
            - chapter
            title: experiments_output
            type: object
        structured_output_enabled: true
        title: å®Ÿé¨“æ§‹é€ ã®æŠ½å‡º
        type: llm
        variables: []
        vision:
          enabled: false
      height: 90
      id: '1762149140611'
      position:
        x: 1246
        y: 507.5
      positionAbsolute:
        x: 1246
        y: 507.5
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        context:
          enabled: false
          variable_selector: []
        desc: ''
        model:
          completion_params: {}
          mode: chat
          name: gpt-5-nano
          provider: langgenius/openai/openai
        prompt_template:
        - id: 83c6acfa-a655-4245-8faf-94069da025b0
          role: system
          text: "ä»¥ä¸‹ã®å®Ÿé¨“æ–¹æ³•ãƒ†ã‚­ã‚¹ãƒˆã‹ã‚‰ã€å„å®Ÿé¨“ã®è©³ç´°æƒ…å ±ã‚’æŠ½å‡ºã—ã¦JSONå½¢å¼ã§å‡ºåŠ›ã—ã¦ãã ã•ã„ã€‚\n\nå®Ÿé¨“æ–¹æ³•ãƒ†ã‚­ã‚¹ãƒˆ:\n{{experiment_methods_text}}\n\
            \nå®Ÿé¨“æ§‹é€ :\n{{experiment_structure}}\n\nå„å®Ÿé¨“ã«ã¤ã„ã¦ä»¥ä¸‹ã‚’æŠ½å‡ºã—ã¦ãã ã•ã„:\n1. æ¸¬å®šæ¡ä»¶: å¤‰åŒ–ã•ã›ã‚‹ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã¨ãã®å€¤ï¼ˆä¾‹:\
            \ \"IB = 20, 40, 60 Î¼A\"ï¼‰\n2. å®Ÿé¨“ç¨®é¡: \"æ¸¬å®š\", \"è¨ˆç®—\", \"åˆ†æ\" ã®ã„ãšã‚Œã‹\n   -\
            \ æ¸¬å®š: å®Ÿéš›ã«æ¸¬å®šè£…ç½®ã‚’ä½¿ã£ã¦æ¸¬å®šã™ã‚‹å®Ÿé¨“\n   - è¨ˆç®—: Mathematicaç­‰ã§è¨ˆç®—ã™ã‚‹å®Ÿé¨“\n   - åˆ†æ: æ¸¬å®šçµæœã‚’æ•´ç†ãƒ»åˆ†æã™ã‚‹å®Ÿé¨“\n\
            3. ä½¿ç”¨ãƒ„ãƒ¼ãƒ«: Mathematicaç­‰ã®è¨ˆç®—ãƒ„ãƒ¼ãƒ«ã‚’ä½¿ç”¨ã™ã‚‹å ´åˆã¯è¨˜è¼‰\n4. å‚ç…§ãƒ‡ãƒ¼ã‚¿: ä»–ã®å®Ÿé¨“ã‚„è¡¨ã‚’å‚ç…§ã™ã‚‹å ´åˆã¯è¨˜è¼‰\n\n\
            å‡ºåŠ›å½¢å¼:\n[\n  {\n    \"section\": \"4.1.1\",\n    \"idx\": 1,\n    \"subidx\"\
            : 1,\n    \"name\": \"IC - VCEç‰¹æ€§ã®æ¸¬å®š\",\n    \"measurement_conditions\"\
            : \"IB = 20, 40, 60 Î¼A\",\n    \"experiment_type\": \"æ¸¬å®š\",\n    \"tool\"\
            : null,\n    \"reference\": null\n  }\n]\n\nå¿…ãšJSONé…åˆ—å½¢å¼ã§å‡ºåŠ›ã—ã¦ãã ã•ã„ã€‚ä»–ã®ãƒ†ã‚­ã‚¹ãƒˆã¯å«ã‚ãªã„ã§ãã ã•ã„ã€‚"
        - id: 1af4fbcb-5d0f-46e4-bffc-3a73b451de1d
          role: user
          text: 'å®Ÿé¨“æ–¹æ³•ãƒ†ã‚­ã‚¹ãƒˆ:

            ''''''

            {{#1757898488459.text#}}

            ''''''


            å®Ÿé¨“æ§‹é€ :

            ''''''

            {{#1762149140611.text#}}

            '''''''
        selected: false
        structured_output:
          schema:
            description: å®Ÿé¨“é …ç›®ã®å‡ºåŠ›ã‚¹ã‚­ãƒ¼ãƒ
            properties:
              experiments:
                description: å®Ÿé¨“é …ç›®ã®ãƒªã‚¹ãƒˆ
                items:
                  properties:
                    experiment_type:
                      description: å®Ÿé¨“ã®ç¨®é¡
                      enum:
                      - æ¸¬å®š
                      - è¨ˆç®—
                      - åˆ†æ
                      type: string
                    idx:
                      description: å®Ÿé¨“ã®å¤§é …ç›®ç•ªå·
                      example: 1
                      type: integer
                    measurement_conditions:
                      description: æ¸¬å®šæ¡ä»¶ï¼ˆãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã¨å€¤ï¼‰
                      example: IB = 20, 40, 60 Î¼A
                      type: string
                    name:
                      description: å®Ÿé¨“é …ç›®ã®åç§°
                      example: IC - VCEç‰¹æ€§ã®æ¸¬å®š
                      type: string
                    reference:
                      description: å‚ç…§ã™ã‚‹ä»–ã®å®Ÿé¨“ã‚„è¡¨ï¼ˆã‚ã‚‹å ´åˆï¼‰
                      example: è¡¨5.1
                      type:
                      - string
                      - 'null'
                    section:
                      description: å®Ÿé¨“æ›¸ã®ã‚»ã‚¯ã‚·ãƒ§ãƒ³ç•ªå·
                      example: 4.1.1
                      type: string
                    subidx:
                      description: å®Ÿé¨“ã®å°é …ç›®ç•ªå·ï¼ˆãªã„å ´åˆã¯nullï¼‰
                      example: 1
                      type:
                      - integer
                      - 'null'
                    tool:
                      description: ä½¿ç”¨ã™ã‚‹è¨ˆç®—ãƒ„ãƒ¼ãƒ«ï¼ˆã‚ã‚‹å ´åˆï¼‰
                      example: Mathematica
                      type:
                      - string
                      - 'null'
                  required:
                  - section
                  - idx
                  - subidx
                  - name
                  - measurement_conditions
                  - experiment_type
                  type: object
                title: experiments
                type: array
            required:
            - experiments
            title: experiments_output
            type: object
        structured_output_enabled: true
        title: è©³ç´°æƒ…å ±æŠ½å‡º
        type: llm
        variables: []
        vision:
          enabled: false
      height: 90
      id: '1762149222224'
      position:
        x: 1550
        y: 507.5
      positionAbsolute:
        x: 1550
        y: 507.5
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        code: "import json\n\ndef main(experiment_details) -> dict:\n    \"\"\"\n\
          \    å„å®Ÿé¨“ã«å›³è¡¨ç•ªå·ã‚’å‰²ã‚Šå½“ã¦ã‚‹\n    \n    Args:\n        experiment_details: structured_outputå½¢å¼ã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ\n\
          \            - Stringå‹ã®å ´åˆ: JSONæ–‡å­—åˆ—ã‚’ãƒ‘ãƒ¼ã‚¹\n            - Dictå‹ã®å ´åˆ: ãã®ã¾ã¾ä½¿ç”¨\n\
          \    \n    Returns:\n        dict: experiment_with_figures ã‚’ã‚­ãƒ¼ã¨ã™ã‚‹è¾æ›¸\n  \
          \  \"\"\"\n    try:\n        # å…¥åŠ›å‹ã®åˆ¤å®šã¨å¤‰æ›\n        if isinstance(experiment_details,\
          \ str):\n            # Stringå‹ã®å ´åˆ: JSONæ–‡å­—åˆ—ã‚’ãƒ‘ãƒ¼ã‚¹\n            data = json.loads(experiment_details)\n\
          \        elif isinstance(experiment_details, dict):\n            # Dictå‹ã®å ´åˆ:\
          \ ãã®ã¾ã¾ä½¿ç”¨\n            data = experiment_details\n        else:\n       \
          \     # ãã®ä»–ã®å‹ã®å ´åˆ: ã‚¨ãƒ©ãƒ¼\n            return {\n                \"experiment_with_figures\"\
          : {\n                    \"error\": f\"Invalid input type: {type(experiment_details)}\"\
          \n                }\n            }\n        \n        # experimentsé…åˆ—ã‚’å–å¾—\n\
          \        if \"experiments\" in data:\n            experiments = data[\"\
          experiments\"]\n        else:\n            # structured_outputå…¨ä½“ãŒæ¸¡ã•ã‚ŒãŸå ´åˆ\n\
          \            if \"structured_output\" in data:\n                experiments\
          \ = data[\"structured_output\"][\"experiments\"]\n            else:\n  \
          \              return {\n                    \"experiment_with_figures\"\
          : {\n                        \"error\": \"experiments key not found in input\"\
          \n                    }\n                }\n        \n        chapter =\
          \ 5  # å®Ÿé¨“çµæœã®ç« ç•ªå·\n        \n        table_counter = 1\n        fig_counter\
          \ = 1\n        \n        result = []\n        \n        for exp in experiments:\n\
          \            exp_data = {\n                \"section\": exp.get(\"section\"\
          , \"\"),\n                \"idx\": exp.get(\"idx\", 0),\n              \
          \  \"subidx\": exp.get(\"subidx\"),\n                \"name\": exp.get(\"\
          name\", \"\"),\n                \"measurement_conditions\": exp.get(\"measurement_conditions\"\
          , \"\"),\n                \"experiment_type\": exp.get(\"experiment_type\"\
          , \"\"),\n                \"tool\": exp.get(\"tool\"),\n               \
          \ \"reference\": exp.get(\"reference\"),\n                \"tables\": [],\n\
          \                \"figures\": []\n            }\n            \n        \
          \    # å®Ÿé¨“ç¨®é¡ã«å¿œã˜ã¦å›³è¡¨ã‚’å‰²ã‚Šå½“ã¦\n            if exp.get(\"experiment_type\") == \"\
          æ¸¬å®š\":\n                # ãƒ‡ãƒ¼ã‚¿è¡¨ + ã‚°ãƒ©ãƒ•\n                exp_data[\"tables\"\
          ].append({\n                    \"number\": table_counter,\n           \
          \         \"label\": f\"è¡¨{chapter}.{table_counter}\",\n                \
          \    \"type\": \"data\"\n                })\n                table_counter\
          \ += 1\n                \n                exp_data[\"figures\"].append({\n\
          \                    \"number\": fig_counter,\n                    \"label\"\
          : f\"å›³{chapter}.{fig_counter}\",\n                    \"type\": \"graph\"\
          \n                })\n                fig_counter += 1\n               \
          \ \n            elif exp.get(\"experiment_type\") == \"è¨ˆç®—\":\n         \
          \       # ã‚°ãƒ©ãƒ•ã®ã¿\n                exp_data[\"figures\"].append({\n      \
          \              \"number\": fig_counter,\n                    \"label\":\
          \ f\"å›³{chapter}.{fig_counter}\",\n                    \"type\": \"graph\"\
          \n                })\n                fig_counter += 1\n               \
          \ \n            elif exp.get(\"experiment_type\") == \"åˆ†æ\":\n         \
          \       # è¨ˆç®—çµæœè¡¨ + ã‚°ãƒ©ãƒ•\n                exp_data[\"tables\"].append({\n \
          \                   \"number\": table_counter,\n                    \"label\"\
          : f\"è¡¨{chapter}.{table_counter}\",\n                    \"type\": \"result\"\
          \n                })\n                table_counter += 1\n             \
          \   \n                exp_data[\"figures\"].append({\n                 \
          \   \"number\": fig_counter,\n                    \"label\": f\"å›³{chapter}.{fig_counter}\"\
          ,\n                    \"type\": \"graph\"\n                })\n       \
          \         fig_counter += 1\n            \n            result.append(exp_data)\n\
          \        \n        # å‡ºåŠ›ã¯Objectå‹ã¨ã—ã¦è¿”ã™ï¼ˆexperimentsé…åˆ—ã‚’å«ã‚€ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆï¼‰\n        return\
          \ {\n            \"experiment_with_figures\": {\n                \"experiments\"\
          : result\n            }\n        }\n        \n    except Exception as e:\n\
          \        return {\n            \"experiment_with_figures\": {\n        \
          \        \"error\": f\"å‡¦ç†ã‚¨ãƒ©ãƒ¼: {str(e)}\"\n            }\n        }"
        code_language: python3
        desc: ''
        outputs:
          experiment_with_figures:
            children: null
            type: object
        selected: false
        title: å›³è¡¨å‰²ã‚Šå½“ã¦
        type: code
        variables:
        - value_selector:
          - '1762149222224'
          - structured_output
          value_type: object
          variable: experiment_details
      height: 54
      id: '1762149794973'
      position:
        x: 1854
        y: 507.5
      positionAbsolute:
        x: 1854
        y: 507.5
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        context:
          enabled: false
          variable_selector: []
        desc: ''
        model:
          completion_params: {}
          mode: chat
          name: gpt-5-nano
          provider: langgenius/openai/openai
        prompt_template:
        - id: 2f8c0155-1254-4410-99aa-8b1a23d880db
          role: system
          text: 'ä»¥ä¸‹ã®å®Ÿé¨“ãƒ‡ãƒ¼ã‚¿ã«å¯¾ã—ã¦ã€description_briefã‚’ç”Ÿæˆã—ã¦JSONå½¢å¼ã§å‡ºåŠ›ã—ã¦ãã ã•ã„ã€‚


            å®Ÿé¨“ãƒ‡ãƒ¼ã‚¿:

            {{experiment_with_figures}}


            description_briefç”Ÿæˆãƒ«ãƒ¼ãƒ«:


            ã€æ¸¬å®šå®Ÿé¨“ã®å ´åˆã€‘

            ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ: "ã€œã«ãŠã„ã¦ã€ã€œã‚’æ¸¬å®šã—ãŸçµæœã‚’è¡¨X.XãŠã‚ˆã³å›³X.Xã«ç¤ºã™ã€‚"

            ä¾‹: "ã‚¨ãƒŸãƒƒã‚¿æ¥åœ°å›è·¯ã«ãŠã„ã¦ã€IB = 20, 40, 60 Î¼Aã®å„ãƒ™ãƒ¼ã‚¹é›»æµã«å¯¾ã™ã‚‹IC - VCEç‰¹æ€§ã‚’æ¸¬å®šã—ãŸçµæœã‚’è¡¨5.1ãŠã‚ˆã³å›³5.1ã«ç¤ºã™ã€‚"


            ã€è¨ˆç®—å®Ÿé¨“ã®å ´åˆã€‘

            ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ: "ã€œã‚’ç”¨ã„ã¦ã€œã‚’è¨ˆç®—ã—ãŸçµæœã‚’å›³X.Xã«ç¤ºã™ã€‚"

            ä¾‹: "å®Ÿé¨“ã§ä½¿ç”¨ã—ãŸç´ å­ã®å€¤(è¡¨5.2)ã‚’ç”¨ã„ã¦1æ¬¡ä½åŸŸãƒ•ã‚£ãƒ«ã‚¿ã®ã‚¹ãƒ†ãƒƒãƒ—å¿œç­”æ³¢å½¢ã‚’Mathematicaã§è¨ˆç®—ã—ãŸçµæœã‚’å›³5.11ã«ç¤ºã™ã€‚"


            ã€åˆ†æå®Ÿé¨“ã®å ´åˆã€‘

            ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ: "ã€œã®çµæœã‚’æ•´ç†ã—ã¦ã€œã‚’ä½œæˆã—ã€ã€œã‚’æ±‚ã‚ãŸçµæœã‚’è¡¨X.Xã«ç¤ºã™ã€‚"

            ä¾‹: "å®Ÿé¨“1.1ã®çµæœã‚’æ•´ç†ã—ã¦IC - IBã‚°ãƒ©ãƒ•ã‚’ä½œæˆã—ã€æœ€å°äºŒä¹—æ³•ã«ã‚ˆã‚Šè¿‘ä¼¼ç›´ç·šã‚’å¼•ã„ãŸçµæœã‚’å›³5.3ã«ç¤ºã™ã€‚ã“ã®è¿‘ä¼¼ç›´ç·šã®å‚¾ãã‹ã‚‰ã‚¨ãƒŸãƒƒã‚¿æ¥åœ°é›»æµå¢—å¹…ç‡Î²ã‚’æ±‚ã‚ãŸçµæœã‚’è¡¨5.3ã«ç¤ºã™ã€‚"


            æ³¨æ„ç‚¹:

            1. æ¸¬å®šæ¡ä»¶ï¼ˆmeasurement_conditionsï¼‰ã‚’å¿…ãšå«ã‚ã‚‹

            2. å›³è¡¨ç•ªå·ï¼ˆtables, figuresï¼‰ã‚’æ­£ç¢ºã«è¨˜è¼‰

            3. ä½¿ç”¨ã—ãŸå›è·¯å›³ã¸ã®å‚ç…§ã¯å«ã‚ãªã„

            4. ç°¡æ½”ã«1ã€œ2æ–‡ã§è¨˜è¿°


            å„å®Ÿé¨“ãƒ‡ãƒ¼ã‚¿ã«description_briefãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚’è¿½åŠ ã—ã¦ã€JSONé…åˆ—å½¢å¼ã§å‡ºåŠ›ã—ã¦ãã ã•ã„ã€‚

            ä»–ã®ãƒ†ã‚­ã‚¹ãƒˆã¯å«ã‚ãªã„ã§ãã ã•ã„ã€‚'
        - id: 92d6f457-5653-4d95-9a46-1b868b78b594
          role: user
          text: 'å®Ÿé¨“ãƒ‡ãƒ¼ã‚¿:

            ''''''

            {{#1762149794973.experiment_with_figures#}}


            '''''''
        selected: false
        structured_output:
          schema:
            properties:
              experiments:
                description: èª¬æ˜æ–‡ãŒè¿½åŠ ã•ã‚ŒãŸå®Ÿé¨“ãƒ‡ãƒ¼ã‚¿ã®ãƒªã‚¹ãƒˆ
                items:
                  properties:
                    description_brief:
                      description: å®Ÿé¨“ã®ç°¡æ½”ãªèª¬æ˜æ–‡ï¼ˆ1ã€œ2æ–‡ï¼‰ã€‚æ¸¬å®šæ¡ä»¶ã¨å›³è¡¨ç•ªå·ã‚’å«ã‚€ã€‚
                      example: ã‚¨ãƒŸãƒƒã‚¿æ¥åœ°å›è·¯ã«ãŠã„ã¦ã€IB = 20, 40, 60 Î¼Aã®å„ãƒ™ãƒ¼ã‚¹é›»æµã«å¯¾ã™ã‚‹IC - VCEç‰¹æ€§ã‚’æ¸¬å®šã—ãŸçµæœã‚’è¡¨5.1ãŠã‚ˆã³å›³5.1ã«ç¤ºã™ã€‚
                      type: string
                    experiment_type:
                      description: å®Ÿé¨“ã®ç¨®é¡
                      enum:
                      - æ¸¬å®š
                      - è¨ˆç®—
                      - åˆ†æ
                      type: string
                    figures:
                      description: ã“ã®å®Ÿé¨“ã«é–¢é€£ã™ã‚‹å›³ã®ãƒªã‚¹ãƒˆ
                      items:
                        properties:
                          label:
                            description: å›³ã®ãƒ©ãƒ™ãƒ«
                            example: å›³5.1
                            type: string
                          number:
                            description: å›³ã®é€šã—ç•ªå·
                            example: 1
                            type: integer
                          type:
                            description: å›³ã®ç¨®é¡
                            enum:
                            - graph
                            type: string
                        required:
                        - number
                        - label
                        - type
                        type: object
                      type: array
                    idx:
                      description: å®Ÿé¨“ã®å¤§é …ç›®ç•ªå·
                      example: 1
                      type: integer
                    measurement_conditions:
                      description: æ¸¬å®šæ¡ä»¶ï¼ˆãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã¨å€¤ï¼‰
                      example: IB = 20, 40, 60 Î¼A
                      type: string
                    name:
                      description: å®Ÿé¨“é …ç›®ã®åç§°
                      example: IC - VCEç‰¹æ€§ã®æ¸¬å®š
                      type: string
                    reference:
                      description: å‚ç…§ã™ã‚‹ä»–ã®å®Ÿé¨“ã‚„è¡¨ï¼ˆã‚ã‚‹å ´åˆï¼‰
                      example: å®Ÿé¨“1.1
                      type:
                      - string
                      - 'null'
                    section:
                      description: å®Ÿé¨“æ›¸ã®ã‚»ã‚¯ã‚·ãƒ§ãƒ³ç•ªå·
                      example: 4.1.1
                      type: string
                    subidx:
                      description: å®Ÿé¨“ã®å°é …ç›®ç•ªå·ï¼ˆãªã„å ´åˆã¯nullï¼‰
                      example: 1
                      type:
                      - integer
                      - 'null'
                    tables:
                      description: ã“ã®å®Ÿé¨“ã«é–¢é€£ã™ã‚‹è¡¨ã®ãƒªã‚¹ãƒˆ
                      items:
                        properties:
                          label:
                            description: è¡¨ã®ãƒ©ãƒ™ãƒ«
                            example: è¡¨5.1
                            type: string
                          number:
                            description: è¡¨ã®é€šã—ç•ªå·
                            example: 1
                            type: integer
                          type:
                            description: 'è¡¨ã®ç¨®é¡ï¼ˆdata: æ¸¬å®šãƒ‡ãƒ¼ã‚¿, result: è¨ˆç®—çµæœï¼‰'
                            enum:
                            - data
                            - result
                            type: string
                        required:
                        - number
                        - label
                        - type
                        type: object
                      type: array
                    tool:
                      description: ä½¿ç”¨ã™ã‚‹è¨ˆç®—ãƒ„ãƒ¼ãƒ«ï¼ˆã‚ã‚‹å ´åˆï¼‰
                      example: Mathematica
                      type:
                      - string
                      - 'null'
                  required:
                  - section
                  - idx
                  - subidx
                  - name
                  - measurement_conditions
                  - experiment_type
                  - tool
                  - reference
                  - tables
                  - figures
                  - description_brief
                  type: object
                type: array
            required:
            - experiments
            type: object
        structured_output_enabled: true
        title: èª¬æ˜æ–‡ç”Ÿæˆ
        type: llm
        variables: []
        vision:
          enabled: false
      height: 90
      id: '1762149904873'
      position:
        x: 2158
        y: 507.5
      positionAbsolute:
        x: 2158
        y: 507.5
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        code: "import json\n\ndef main(experiment_with_descriptions) -> dict:\n  \
          \  \"\"\"\n    æœ€çµ‚çš„ãªJSONå½¢å¼ã«çµ„ã¿ç«‹ã¦ã€æ¤œè¨¼ã™ã‚‹\n    \n    Args:\n        experiment_with_descriptions:\
          \ structured_outputå½¢å¼ã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ\n    \n    Returns:\n        dict: final_json\
          \ (Object), validation_status (String), validation_message (String)\n  \
          \  \"\"\"\n    try:\n        # å…¥åŠ›å‹ã®åˆ¤å®šã¨å¤‰æ›\n        if isinstance(experiment_with_descriptions,\
          \ str):\n            # Stringå‹ã®å ´åˆ: JSONæ–‡å­—åˆ—ã‚’ãƒ‘ãƒ¼ã‚¹\n            data = json.loads(experiment_with_descriptions)\n\
          \        elif isinstance(experiment_with_descriptions, dict):\n        \
          \    # Dictå‹ã®å ´åˆ: ãã®ã¾ã¾ä½¿ç”¨\n            data = experiment_with_descriptions\n\
          \        else:\n            # ãã®ä»–ã®å‹ã®å ´åˆ: ã‚¨ãƒ©ãƒ¼\n            return {\n    \
          \            \"final_json\": {\"error\": f\"Invalid input type: {type(experiment_with_descriptions)}\"\
          },\n                \"validation_status\": \"error\",\n                \"\
          validation_message\": f\"Invalid input type: {type(experiment_with_descriptions)}\"\
          \n            }\n        \n        # experimentsé…åˆ—ã‚’å–å¾—\n        if \"experiments\"\
          \ in data:\n            experiments = data[\"experiments\"]\n        else:\n\
          \            # structured_outputå…¨ä½“ãŒæ¸¡ã•ã‚ŒãŸå ´åˆ\n            if \"structured_output\"\
          \ in data:\n                experiments = data[\"structured_output\"][\"\
          experiments\"]\n            else:\n                return {\n          \
          \          \"final_json\": {\"error\": \"experiments key not found\"},\n\
          \                    \"validation_status\": \"error\",\n               \
          \     \"validation_message\": \"experiments key not found in input\"\n \
          \               }\n        \n        chapter = 5\n        \n        final_experiments\
          \ = []\n        \n        for exp in experiments:\n            # è¡¨ã®ã‚­ãƒ£ãƒ—ã‚·ãƒ§ãƒ³ã‚’ç”Ÿæˆ\n\
          \            tables = []\n            for table in exp.get(\"tables\", []):\n\
          \                table_type = table.get(\"type\", \"\")\n              \
          \  exp_name = exp.get(\"name\", \"\")\n                \n              \
          \  if table_type == \"data\":\n                    caption = f\"{exp_name}æ¸¬å®šãƒ‡ãƒ¼ã‚¿\"\
          \n                elif table_type == \"result\":\n                    #\
          \ \"ã€œã®æ¸¬å®š\" ã‚„ \"ç‰¹æ€§\" ã‚’å‰Šé™¤\n                    caption = exp_name.replace(\"\
          ã®æ¸¬å®š\", \"\").replace(\"ç‰¹æ€§\", \"\").strip()\n                    if not caption:\n\
          \                        caption = exp_name\n                else:\n   \
          \                 caption = exp_name\n                \n               \
          \ tables.append({\n                    \"label\": table.get(\"label\", \"\
          \"),\n                    \"caption\": caption\n                })\n   \
          \         \n            # å›³ã®ã‚­ãƒ£ãƒ—ã‚·ãƒ§ãƒ³ã‚’ç”Ÿæˆ\n            figures = []\n      \
          \      for figure in exp.get(\"figures\", []):\n                exp_type\
          \ = exp.get(\"experiment_type\", \"\")\n                exp_tool = exp.get(\"\
          tool\")\n                exp_name = exp.get(\"name\", \"\")\n          \
          \      \n                if exp_type == \"è¨ˆç®—\" and exp_tool:\n         \
          \           caption = f\"è¨ˆç®—ä¸Šã®{exp_name}\"\n                else:\n     \
          \               caption = exp_name\n                \n                figures.append({\n\
          \                    \"label\": figure.get(\"label\", \"\"),\n         \
          \           \"caption\": caption\n                })\n            \n   \
          \         # æœ€çµ‚å®Ÿé¨“ãƒ‡ãƒ¼ã‚¿ã‚’æ§‹ç¯‰\n            exp_data = {\n                \"idx\"\
          : exp.get(\"idx\", 0),\n                \"subidx\": exp.get(\"subidx\"),\n\
          \                \"name\": exp.get(\"name\", \"\"),\n                \"\
          description_brief\": exp.get(\"description_brief\", \"\"),\n           \
          \     \"tables\": tables,\n                \"figures\": figures\n      \
          \      }\n            \n            final_experiments.append(exp_data)\n\
          \        \n        # æœ€çµ‚JSONæ§‹é€ ï¼ˆObjectå‹ã¨ã—ã¦è¿”ã™ï¼‰\n        final_json_obj = {\n\
          \            \"chapter\": chapter,\n            \"experiments\": final_experiments\n\
          \        }\n        \n        # æ¤œè¨¼\n        validation_result = validate_json(final_json_obj)\n\
          \        \n        if validation_result[\"valid\"]:\n            return\
          \ {\n                \"final_json\": final_json_obj,  # Objectå‹ã¨ã—ã¦è¿”ã™\n \
          \               \"validation_status\": \"success\",\n                \"\
          validation_message\": \"JSONã®æ¤œè¨¼ã«æˆåŠŸã—ã¾ã—ãŸ\"\n            }\n        else:\n\
          \            return {\n                \"final_json\": final_json_obj, \
          \ # ã‚¨ãƒ©ãƒ¼ã§ã‚‚Objectå‹ã¨ã—ã¦è¿”ã™\n                \"validation_status\": \"error\"\
          ,\n                \"validation_message\": f\"æ¤œè¨¼ã‚¨ãƒ©ãƒ¼: {validation_result['message']}\"\
          \n            }\n            \n    except Exception as e:\n        return\
          \ {\n            \"final_json\": {\"error\": str(e)},  # ã‚¨ãƒ©ãƒ¼æƒ…å ±ã‚’Objectå‹ã§è¿”ã™\n\
          \            \"validation_status\": \"error\",\n            \"validation_message\"\
          : f\"å‡¦ç†ã‚¨ãƒ©ãƒ¼: {str(e)}\"\n        }\n\ndef validate_json(data):\n    \"\"\"\
          \n    JSONæ§‹é€ ã‚’æ¤œè¨¼\n    \n    Args:\n        data: æ¤œè¨¼å¯¾è±¡ã®JSONæ§‹é€ \n    \n    Returns:\n\
          \        dict: valid (bool) ã¨ message (str) ã‚’å«ã‚€è¾æ›¸\n    \"\"\"\n    try:\n\
          \        # å¿…é ˆãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã®ç¢ºèª\n        if \"chapter\" not in data:\n           \
          \ return {\"valid\": False, \"message\": \"chapterãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ãŒå¿…è¦ã§ã™\"}\n      \
          \  if \"experiments\" not in data:\n            return {\"valid\": False,\
          \ \"message\": \"experimentsãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ãŒå¿…è¦ã§ã™\"}\n        \n        for i, exp\
          \ in enumerate(data[\"experiments\"]):\n            # å¿…é ˆãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰\n        \
          \    required_fields = [\"idx\", \"subidx\", \"name\", \"description_brief\"\
          , \"tables\", \"figures\"]\n            for field in required_fields:\n\
          \                if field not in exp:\n                    return {\"valid\"\
          : False, \"message\": f\"å®Ÿé¨“{i+1}: {field}ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ãŒå¿…è¦ã§ã™\"}\n            \n \
          \           # ã‚°ãƒ©ãƒ•ãŒã‚ã‚‹å ´åˆã¯ãƒ‡ãƒ¼ã‚¿è¡¨ã‚‚å¿…è¦ï¼ˆè¨ˆç®—å®Ÿé¨“ã‚’é™¤ãï¼‰\n            exp_name = exp.get(\"\
          name\", \"\")\n            if len(exp[\"figures\"]) > 0 and \"è¨ˆç®—\" not in\
          \ exp_name:\n                if len(exp[\"tables\"]) == 0:\n           \
          \         return {\"valid\": False, \"message\": f\"å®Ÿé¨“ã€Œ{exp_name}ã€: ã‚°ãƒ©ãƒ•ãŒã‚ã‚‹å ´åˆã¯ãƒ‡ãƒ¼ã‚¿è¡¨ã‚‚å¿…è¦ã§ã™\"\
          }\n        \n        return {\"valid\": True, \"message\": \"æ¤œè¨¼æˆåŠŸ\"}\n \
          \       \n    except Exception as e:\n        return {\"valid\": False,\
          \ \"message\": f\"æ¤œè¨¼ä¸­ã«ã‚¨ãƒ©ãƒ¼: {str(e)}\"}"
        code_language: python3
        desc: ''
        outputs:
          final_json:
            children: null
            type: object
          validation_message:
            children: null
            type: string
          validation_status:
            children: null
            type: string
        selected: false
        title: JSONçµ„ã¿ç«‹ã¦ãƒ»æ¤œè¨¼
        type: code
        variables:
        - value_selector:
          - '1762149904873'
          - structured_output
          value_type: object
          variable: experiment_with_descriptions
      height: 54
      id: '1762150135474'
      position:
        x: 2462
        y: 525.5
      positionAbsolute:
        x: 2462
        y: 525.5
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        code: "import json\nfrom typing import Any, Dict, List\n\ndef ensure_dict(x:\
          \ Any) -> Dict:\n    \"\"\"æ–‡å­—åˆ—ãªã‚‰ JSON ã¨ã—ã¦ decodeã€dict ä»¥å¤–ã¯ç©º dict ã«è½ã¨ã™\"\"\
          \"\n    if isinstance(x, dict):\n        return x\n    if isinstance(x,\
          \ str):\n        try:\n            return json.loads(x)\n        except\
          \ Exception:\n            return {}\n    return {}\n\ndef unwrap_common_wrappers(d:\
          \ Dict) -> Dict:\n    \"\"\"\n    Dify ã§ã‚ã‚ŠãŒã¡ãª result / output / data ãƒ©ãƒƒãƒ—ã‚’1æ®µã ã‘å‰¥ãŒã™ã€‚\n\
          \    å†…å´ã« summary / units / experiments ã®ã©ã‚Œã‹ãŒã‚ã‚Œã°å„ªå…ˆçš„ã«ãã“ã‚’è¦‹ã‚‹ã€‚\n    \"\"\"\n\
          \    if not isinstance(d, dict):\n        return {}\n\n    keys_of_interest\
          \ = {\"summary\", \"units\", \"experiments\", \"chapter\", \"total_count\"\
          }\n\n    # ã™ã§ã«å¿…è¦ãªã‚­ãƒ¼ã‚’ç›´æ¥æŒã£ã¦ã„ã‚Œã°ãã®ã¾ã¾è¿”ã™\n    if keys_of_interest & d.keys():\n\
          \        return d\n\n    # ã‚ˆãã‚ã‚‹ãƒ©ãƒƒãƒ‘ãƒ¼ result / output / data ã‚’ãƒã‚§ãƒƒã‚¯\n    for\
          \ wrapper in (\"result\", \"output\", \"data\"):\n        inner = d.get(wrapper)\n\
          \        if isinstance(inner, dict) and (keys_of_interest & inner.keys()):\n\
          \            return inner\n\n    # ãã‚Œã£ã½ããªã‘ã‚Œã°ãã®ã¾ã¾\n    return d\n\ndef main(inputs=None,\
          \ **kwargs) -> dict:\n    \"\"\"\n    3ã¤ã® JSON ã‚’çµåˆã—ã€chapter / experiments\
          \ / summary / units / references ã‚’\n    1ã¤ã® JSON ã«æ•´ç†ã—ã¦è¿”ã™ã€‚\n    ã©ã® input\
          \ ã«ä½•ãŒå…¥ã£ã¦ã„ã¦ã‚‚ã€è‡ªå‹•çš„ã«æ¤œå‡ºã™ã‚‹ã€‚\n    \"\"\"\n    data = inputs if isinstance(inputs,\
          \ dict) else kwargs\n\n    # å…¥åŠ›ã‚’ dict ã«æ­£è¦åŒ–ã—ã¦ unwrap\n    js_list: List[Dict]\
          \ = []\n    for key in (\"input_json1\", \"input_json2\", \"input_json3\"\
          ):\n        raw = data.get(key)\n        d = unwrap_common_wrappers(ensure_dict(raw))\n\
          \        js_list.append(d)\n\n    merged = {\n        \"chapter\": None,\n\
          \        \"experiments\": [],\n        \"summary\": None,\n        \"units\"\
          : [],\n        \"total_count\": None,\n        \"references\": [],\n   \
          \     \"reference_list_formatted\": [],\n    }\n\n    for js in js_list:\n\
          \        if not isinstance(js, dict):\n            continue\n\n        #\
          \ chapterï¼šã¾ã å…¥ã£ã¦ã„ãªãã¦ã€js ãŒæŒã£ã¦ã„ã‚Œã°æ¡ç”¨\n        if merged[\"chapter\"] is None\
          \ and \"chapter\" in js:\n            merged[\"chapter\"] = js.get(\"chapter\"\
          )\n\n        # experimentsï¼šlist ãªã‚‰å…¨éƒ¨çµåˆ\n        exps = js.get(\"experiments\"\
          )\n        if isinstance(exps, list):\n            merged[\"experiments\"\
          ].extend(exps)\n\n        # summaryï¼šã¾ã å…¥ã£ã¦ã„ãªãã¦ã€js ãŒæŒã£ã¦ã„ã‚Œã°æ¡ç”¨\n        if merged[\"\
          summary\"] is None and \"summary\" in js:\n            merged[\"summary\"\
          ] = js.get(\"summary\")\n\n        # units / total_countï¼šã¾ã å…¥ã£ã¦ã„ãªãã¦ã€js ãŒæŒã£ã¦ã„ã‚Œã°æ¡ç”¨\n\
          \        if not merged[\"units\"] and isinstance(js.get(\"units\"), list):\n\
          \            merged[\"units\"] = js.get(\"units\", [])\n            if \"\
          total_count\" in js:\n                merged[\"total_count\"] = js.get(\"\
          total_count\")\n\n        # references\n        if not merged[\"references\"\
          ] and \"references\" in js:\n            merged[\"references\"] = js.get(\"\
          references\") or []\n\n        # reference_list_formatted\n        if (not\
          \ merged[\"reference_list_formatted\"] \n                and \"reference_list_formatted\"\
          \ in js):\n            merged[\"reference_list_formatted\"] = js.get(\"\
          reference_list_formatted\") or []\n\n    return {\"merged_json\": merged}\n"
        code_language: python3
        desc: ''
        outputs:
          merged_json:
            children: null
            type: object
        selected: false
        title: çµåˆ
        type: code
        variables:
        - value_selector:
          - '1762150135474'
          - final_json
          value_type: object
          variable: input_json1
        - value_selector:
          - '17588915586900'
          - structured_output
          value_type: object
          variable: input_json2
        - value_selector:
          - '1758678491529'
          - structured_output
          value_type: object
          variable: input_json3
      height: 54
      id: '1762152538729'
      position:
        x: 2739.034950689864
        y: 382.14268680379894
      positionAbsolute:
        x: 2739.034950689864
        y: 382.14268680379894
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    viewport:
      x: 109.57519506035663
      y: 306.0989375531971
      zoom: 0.26680428825410596
